<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns:dc="http://purl.org/dc/elements/1.1/" 
     xmlns:cc="http://creativecommons.org/ns#" 
     xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
     xmlns:svg="http://www.w3.org/2000/svg" 
     xmlns="http://www.w3.org/2000/svg" 
     id="svg8" version="1.1" 
     viewBox="0 0 120 100" 
     height="100mm" width="120mm">
  <defs id="defs2" />
  <metadata id="metadata5">
    <rdf:RDF>
      <cc:Work rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g transform="translate(0,-197)" style="display:inline" id="layer2">
    <path id="eyelid_top" d="m 11.71726,249.56398 c 18.659656,-18.65965 59.556243,-20.00774 79.563983,0" style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
    <path style="fill:none;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" d="m 11.71726,249.88101 c 18.659656,18.65966 59.556243,20.00775 79.563983,0" id="eyelid_bottom" />
    <circle r="10.819569" cy="249.70573" cx="52.207966" id="iris" style="opacity:1;fill:none;fill-opacity:0.99607843;stroke:#000000;stroke-width:1;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
    <circle style="opacity:1;fill:#000000;fill-opacity:1;stroke:none;stroke-width:1;stroke-linecap:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="pupil" cx="52.207966" cy="249.70573" r="4.5829616" />
    <flowRoot style="font-style:normal;font-weight:normal;font-size:40px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none" id="flowRoot853" xml:space="preserve"><flowRegion id="flowRegion855"><rect y="522.51971" x="221.42857" height="594.81079" width="360" id="rect857" /></flowRegion><flowPara id="flowPara859" /></flowRoot>  </g>
  <g transform="translate(0,-197)" style="display:inline" id="layer1">
    <path id="glass" d="m 41.963845,222.47737 a 26.994225,26.994225 0 0 0 -26.99422,26.99422 26.994225,26.994225 0 0 0 26.99422,26.99421 26.994225,26.994225 0 0 0 26.994214,-26.99421 26.994225,26.994225 0 0 0 -26.994214,-26.99422 z m 19.778111,46.23748 18.575103,18.57562 z" style="opacity:1;fill:none;fill-opacity:0.99607843;stroke:#000000;stroke-width:2.79999995;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" />
  </g>
  <g transform="translate(0,-197)" style="display:inline" id="layer3">
    <text id="text_nexa" y="303.04376" x="7.0054269" style="font-style:normal;font-weight:normal;font-size:2.82222223px;line-height:1;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;display:inline;opacity:0.93999999;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.26458332" xml:space="preserve"><tspan style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="303.04376" x="7.0054269" id="tspan1145">unsigned int audit_serial(void)</tspan><tspan id="tspan1149" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="305.89297" x="7.0054269">{</tspan><tspan id="tspan1151" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="308.74219" x="7.0054269">	static atomic_t serial = ATOMIC_INIT(0);</tspan><tspan id="tspan1153" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="311.59143" x="7.0054269" /><tspan id="tspan1155" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="314.41364" x="7.0054269">	return atomic_add_return(1, &amp;serial);</tspan><tspan id="tspan1157" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="317.26285" x="7.0054269">}</tspan><tspan id="tspan1159" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="320.11206" x="7.0054269" /><tspan id="tspan1161" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="322.9343" x="7.0054269">static inline void audit_get_stamp(struct audit_context *ctx,</tspan><tspan id="tspan1163" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="325.78351" x="7.0054269">				   struct timespec64 *t, unsigned int *serial)</tspan><tspan id="tspan1165" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="328.63272" x="7.0054269">{</tspan><tspan id="tspan1167" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="331.48196" x="7.0054269">	if (!ctx || !auditsc_get_stamp(ctx, t, serial)) {</tspan><tspan id="tspan1169" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="334.33118" x="7.0054269">		ktime_get_coarse_real_ts64(t);</tspan><tspan id="tspan1171" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="337.18039" x="7.0054269">		*serial = audit_serial();</tspan><tspan id="tspan1173" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="340.0296" x="7.0054269">	}</tspan><tspan id="tspan1175" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="342.87881" x="7.0054269">}</tspan><tspan id="tspan1177" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="345.72803" x="7.0054269" /><tspan id="tspan1179" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="348.55026" x="7.0054269">/**</tspan><tspan id="tspan1181" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="351.39948" x="7.0054269"> * audit_log_start - obtain an audit buffer</tspan><tspan id="tspan1183" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="354.24869" x="7.0054269"> * @ctx: audit_context (may be NULL)</tspan><tspan id="tspan1185" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="357.09793" x="7.0054269"> * @gfp_mask: type of allocation</tspan><tspan id="tspan1187" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="359.94714" x="7.0054269"> * @type: audit message type</tspan><tspan id="tspan1189" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="362.79636" x="7.0054269"> *</tspan><tspan id="tspan1191" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="365.64557" x="7.0054269"> * Returns audit_buffer pointer on success or NULL on error.</tspan><tspan id="tspan1193" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="368.49478" x="7.0054269"> *</tspan><tspan id="tspan1195" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="371.34399" x="7.0054269"> * Obtain an audit buffer.  This routine does locking to obtain the</tspan><tspan id="tspan1197" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="374.19324" x="7.0054269"> * audit buffer, but then no locking is required for calls to</tspan><tspan id="tspan1199" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="377.04245" x="7.0054269"> * audit_log_*format.  If the task (ctx) is a task that is currently in a</tspan><tspan id="tspan1201" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="379.89166" x="7.0054269"> * syscall, then the syscall is marked as auditable and an audit record</tspan><tspan id="tspan1203" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="382.74088" x="7.0054269"> * will be written at syscall exit.  If there is no associated task, then</tspan><tspan id="tspan1205" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="385.59009" x="7.0054269"> * task context (ctx) should be NULL.</tspan><tspan id="tspan1207" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="388.43933" x="7.0054269"> */</tspan><tspan id="tspan1209" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="391.28854" x="7.0054269">struct audit_buffer *audit_log_start(struct audit_context *ctx, gfp_t gfp_mask,</tspan><tspan id="tspan1211" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="394.13776" x="7.0054269">				     int type)</tspan><tspan id="tspan1213" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="396.98697" x="7.0054269">{</tspan><tspan id="tspan1215" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="399.83618" x="7.0054269">	struct audit_buffer *ab;</tspan><tspan id="tspan1217" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="402.68539" x="7.0054269">	struct timespec64 t;</tspan><tspan id="tspan1219" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="405.53464" x="7.0054269">	unsigned int uninitialized_var(serial);</tspan><tspan id="tspan1221" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="408.38385" x="7.0054269" /><tspan id="tspan1223" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="411.20605" x="7.0054269">	if (audit_initialized != AUDIT_INITIALIZED)</tspan><tspan id="tspan1225" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="414.0553" x="7.0054269">		return NULL;</tspan><tspan id="tspan1227" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="416.90451" x="7.0054269" /><tspan id="tspan1229" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="419.72672" x="7.0054269">	if (unlikely(!audit_filter(type, AUDIT_FILTER_EXCLUDE)))</tspan><tspan id="tspan1231" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="422.57596" x="7.0054269">		return NULL;</tspan><tspan id="tspan1233" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="425.42517" x="7.0054269" /><tspan id="tspan1235" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="428.24738" x="7.0054269">	/* NOTE: don't ever fail/sleep on these two conditions:</tspan><tspan id="tspan1237" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="431.09659" x="7.0054269">	 * 1. auditd generated record - since we need auditd to drain the</tspan><tspan id="tspan1239" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="433.94583" x="7.0054269">	 *    queue; also, when we are checking for auditd, compare PIDs using</tspan><tspan id="tspan1241" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="436.79504" x="7.0054269">	 *    task_tgid_vnr() since auditd_pid is set in audit_receive_msg()</tspan><tspan id="tspan1243" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="439.64426" x="7.0054269">	 *    using a PID anchored in the caller's namespace</tspan><tspan id="tspan1245" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="442.49347" x="7.0054269">	 * 2. generator holding the audit_cmd_mutex - we don't want to block</tspan><tspan id="tspan1247" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="445.34268" x="7.0054269">	 *    while holding the mutex */</tspan><tspan id="tspan1249" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="448.19193" x="7.0054269">	if (!(auditd_test_task(current) || audit_ctl_owner_current())) {</tspan><tspan id="tspan1251" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="451.04114" x="7.0054269">		long stime = audit_backlog_wait_time;</tspan><tspan id="tspan1253" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="453.89035" x="7.0054269" /><tspan id="tspan1255" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="456.71255" x="7.0054269">		while (audit_backlog_limit &amp;&amp;</tspan><tspan id="tspan1257" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="459.5618" x="7.0054269">		       (skb_queue_len(&amp;audit_queue) &gt; audit_backlog_limit)) {</tspan><tspan id="tspan1259" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="462.41101" x="7.0054269">			/* wake kauditd to try and flush the queue */</tspan><tspan id="tspan1261" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="465.26022" x="7.0054269">			wake_up_interruptible(&amp;kauditd_wait);</tspan><tspan id="tspan1263" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="468.10944" x="7.0054269" /><tspan id="tspan1265" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="470.93167" x="7.0054269">			/* sleep if we are allowed and we haven't exhausted our</tspan><tspan id="tspan1267" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="473.78088" x="7.0054269">			 * backlog wait limit */</tspan><tspan id="tspan1269" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="476.6301" x="7.0054269">			if (gfpflags_allow_blocking(gfp_mask) &amp;&amp; (stime &gt; 0)) {</tspan><tspan id="tspan1271" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="479.47931" x="7.0054269">				DECLARE_WAITQUEUE(wait, current);</tspan><tspan id="tspan1273" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="482.32852" x="7.0054269" /><tspan id="tspan1275" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="485.15076" x="7.0054269">				add_wait_queue_exclusive(&amp;audit_backlog_wait,</tspan><tspan id="tspan1277" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="487.99997" x="7.0054269">							 &amp;wait);</tspan><tspan id="tspan1279" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="490.84918" x="7.0054269">				set_current_state(TASK_UNINTERRUPTIBLE);</tspan><tspan id="tspan1281" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="493.69843" x="7.0054269">				stime = schedule_timeout(stime);</tspan><tspan id="tspan1283" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="496.54764" x="7.0054269">				remove_wait_queue(&amp;audit_backlog_wait, &amp;wait);</tspan><tspan id="tspan1285" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="499.39685" x="7.0054269">			} else {</tspan><tspan id="tspan1287" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="502.24606" x="7.0054269">				if (audit_rate_check() &amp;&amp; printk_ratelimit())</tspan><tspan id="tspan1289" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="505.09528" x="7.0054269">					pr_warn(&quot;audit_backlog=%d &gt; audit_backlog_limit=%d\n&quot;,</tspan><tspan id="tspan1291" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="507.94449" x="7.0054269">						skb_queue_len(&amp;audit_queue),</tspan><tspan id="tspan1293" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="510.79373" x="7.0054269">						audit_backlog_limit);</tspan><tspan id="tspan1295" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="513.64294" x="7.0054269">				audit_log_lost(&quot;backlog limit exceeded&quot;);</tspan><tspan id="tspan1297" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="516.49213" x="7.0054269">				return NULL;</tspan><tspan id="tspan1299" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="519.34137" x="7.0054269">			}</tspan><tspan id="tspan1301" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="522.19061" x="7.0054269">		}</tspan><tspan id="tspan1303" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="525.03979" x="7.0054269">	}</tspan><tspan id="tspan1305" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="527.88904" x="7.0054269" /><tspan id="tspan1307" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="530.71124" x="7.0054269">	ab = audit_buffer_alloc(ctx, gfp_mask, type);</tspan><tspan id="tspan1309" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="533.56049" x="7.0054269">	if (!ab) {</tspan><tspan id="tspan1311" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="536.40967" x="7.0054269">		audit_log_lost(&quot;out of memory in audit_log_start&quot;);</tspan><tspan id="tspan1313" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="539.25891" x="7.0054269">		return NULL;</tspan><tspan id="tspan1315" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="542.10815" x="7.0054269">	}</tspan><tspan id="tspan1317" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="544.95734" x="7.0054269" /><tspan id="tspan1319" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="547.77954" x="7.0054269">	audit_get_stamp(ab-&gt;ctx, &amp;t, &amp;serial);</tspan><tspan id="tspan1321" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="550.62878" x="7.0054269">	audit_log_format(ab, &quot;audit(%llu.%03lu:%u): &quot;,</tspan><tspan id="tspan1323" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="553.47803" x="7.0054269">			 (unsigned long long)t.tv_sec, t.tv_nsec/1000000, serial);</tspan><tspan id="tspan1325" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="556.32721" x="7.0054269" /><tspan id="tspan1327" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="559.14941" x="7.0054269">	return ab;</tspan><tspan id="tspan1329" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="561.99866" x="7.0054269">}</tspan><tspan id="tspan1331" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="564.8479" x="7.0054269" /><tspan id="tspan1333" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="567.6701" x="7.0054269">/**</tspan><tspan id="tspan1335" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="570.51929" x="7.0054269"> * audit_expand - expand skb in the audit buffer</tspan><tspan id="tspan1337" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="573.36853" x="7.0054269"> * @ab: audit_buffer</tspan><tspan id="tspan1339" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="576.21777" x="7.0054269"> * @extra: space to add at tail of the skb</tspan><tspan id="tspan1341" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="579.06696" x="7.0054269"> *</tspan><tspan id="tspan1343" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="581.9162" x="7.0054269"> * Returns 0 (no space) on failed expansion, or available space if</tspan><tspan id="tspan1345" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="584.76538" x="7.0054269"> * successful.</tspan><tspan id="tspan1347" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="587.61462" x="7.0054269"> */</tspan><tspan id="tspan1349" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="590.46387" x="7.0054269">static inline int audit_expand(struct audit_buffer *ab, int extra)</tspan><tspan id="tspan1351" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="593.31305" x="7.0054269">{</tspan><tspan id="tspan1353" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="596.16229" x="7.0054269">	struct sk_buff *skb = ab-&gt;skb;</tspan><tspan id="tspan1355" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="599.01147" x="7.0054269">	int oldtail = skb_tailroom(skb);</tspan><tspan id="tspan1357" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="601.86072" x="7.0054269">	int ret = pskb_expand_head(skb, 0, extra, ab-&gt;gfp_mask);</tspan><tspan id="tspan1359" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="604.70996" x="7.0054269">	int newtail = skb_tailroom(skb);</tspan><tspan id="tspan1361" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="607.55914" x="7.0054269" /><tspan id="tspan1363" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="610.38135" x="7.0054269">	if (ret &lt; 0) {</tspan><tspan id="tspan1365" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="613.23059" x="7.0054269">		audit_log_lost(&quot;out of memory in audit_expand&quot;);</tspan><tspan id="tspan1367" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="616.07983" x="7.0054269">		return 0;</tspan><tspan id="tspan1369" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="618.92902" x="7.0054269">	}</tspan><tspan id="tspan1371" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="621.77826" x="7.0054269" /><tspan id="tspan1373" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="624.60046" x="7.0054269">	skb-&gt;truesize += newtail - oldtail;</tspan><tspan id="tspan1375" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="627.44971" x="7.0054269">	return newtail;</tspan><tspan id="tspan1377" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="630.29889" x="7.0054269">}</tspan><tspan id="tspan1379" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="633.14813" x="7.0054269" /><tspan id="tspan1381" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="635.97034" x="7.0054269">/*</tspan><tspan id="tspan1383" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="638.81958" x="7.0054269"> * Format an audit message into the audit buffer.  If there isn't enough</tspan><tspan id="tspan1385" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="641.66876" x="7.0054269"> * room in the audit buffer, more room will be allocated and vsnprint</tspan><tspan id="tspan1387" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="644.51801" x="7.0054269"> * will be called a second time.  Currently, we assume that a printk</tspan><tspan id="tspan1389" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="647.36725" x="7.0054269"> * can't format message larger than 1024 bytes, so we don't either.</tspan><tspan id="tspan1391" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="650.21643" x="7.0054269"> */</tspan><tspan id="tspan1393" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="653.06567" x="7.0054269">static void audit_log_vformat(struct audit_buffer *ab, const char *fmt,</tspan><tspan id="tspan1395" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="655.91486" x="7.0054269">			      va_list args)</tspan><tspan id="tspan1397" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="658.7641" x="7.0054269">{</tspan><tspan id="tspan1399" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="661.61328" x="7.0054269">	int len, avail;</tspan><tspan id="tspan1401" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="664.46252" x="7.0054269">	struct sk_buff *skb;</tspan><tspan id="tspan1403" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="667.31177" x="7.0054269">	va_list args2;</tspan><tspan id="tspan1405" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="670.16095" x="7.0054269" /><tspan id="tspan1407" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="672.98322" x="7.0054269">	if (!ab)</tspan><tspan id="tspan1409" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="675.8324" x="7.0054269">		return;</tspan><tspan id="tspan1411" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="678.68164" x="7.0054269" /><tspan id="tspan1413" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="681.50385" x="7.0054269">	BUG_ON(!ab-&gt;skb);</tspan><tspan id="tspan1415" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="684.35309" x="7.0054269">	skb = ab-&gt;skb;</tspan><tspan id="tspan1417" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="687.20227" x="7.0054269">	avail = skb_tailroom(skb);</tspan><tspan id="tspan1419" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="690.05151" x="7.0054269">	if (avail == 0) {</tspan><tspan id="tspan1421" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="692.9007" x="7.0054269">		avail = audit_expand(ab, AUDIT_BUFSIZ);</tspan><tspan id="tspan1423" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="695.74994" x="7.0054269">		if (!avail)</tspan><tspan id="tspan1425" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="698.59918" x="7.0054269">			goto out;</tspan><tspan id="tspan1427" style="font-style:normal;font-variant:normal;font-weight:300;font-stretch:normal;font-size:2.82222223px;font-family:Nexa;-inkscape-font-specification:'Nexa, Light';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;stroke-width:0.26458332" y="701.44836" x="7.0054269">	}</tspan></text>
  </g>
  <g transform="translate(0,-197)" style="display:inline" id="layer4">
    <text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;line-height:1;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:start;display:inline;fill:#08437d;fill-opacity:0.70588235;stroke:none;stroke-width:0.26458332" x="12.297093" y="303.04379" id="text_exo"><tspan id="tspan974" x="12.297093" y="303.04379" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332">unsigned int audit_serial(void)</tspan><tspan x="12.297093" y="305.86603" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan976">{</tspan><tspan x="12.297093" y="308.68823" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan978">	static atomic_t serial = ATOMIC_INIT(0);</tspan><tspan x="12.297093" y="311.51047" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan980" /><tspan x="12.297093" y="314.33267" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan982">	return atomic_add_return(1, &amp;serial);</tspan><tspan x="12.297093" y="317.15491" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan984">}</tspan><tspan x="12.297093" y="319.97711" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan986" /><tspan x="12.297093" y="322.79935" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan988">static inline void audit_get_stamp(struct audit_context *ctx,</tspan><tspan x="12.297093" y="325.62158" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan990">				   struct timespec64 *t, unsigned int *serial)</tspan><tspan x="12.297093" y="328.44379" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan992">{</tspan><tspan x="12.297093" y="331.26602" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan994">	if (!ctx || !auditsc_get_stamp(ctx, t, serial)) {</tspan><tspan x="12.297093" y="334.08823" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan996">		ktime_get_coarse_real_ts64(t);</tspan><tspan x="12.297093" y="336.91046" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan998">		*serial = audit_serial();</tspan><tspan x="12.297093" y="339.7327" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1000">	}</tspan><tspan x="12.297093" y="342.5549" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1002">}</tspan><tspan x="12.297093" y="345.37714" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1004" /><tspan x="12.297093" y="348.19934" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1006">/**</tspan><tspan x="12.297093" y="351.02158" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1008"> * audit_log_start - obtain an audit buffer</tspan><tspan x="12.297093" y="353.84378" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1010"> * @ctx: audit_context (may be NULL)</tspan><tspan x="12.297093" y="356.66602" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1012"> * @gfp_mask: type of allocation</tspan><tspan x="12.297093" y="359.48825" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1014"> * @type: audit message type</tspan><tspan x="12.297093" y="362.31046" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1016"> *</tspan><tspan x="12.297093" y="365.13269" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1018"> * Returns audit_buffer pointer on success or NULL on error.</tspan><tspan x="12.297093" y="367.9549" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1020"> *</tspan><tspan x="12.297093" y="370.77713" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1022"> * Obtain an audit buffer.  This routine does locking to obtain the</tspan><tspan x="12.297093" y="373.59933" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1024"> * audit buffer, but then no locking is required for calls to</tspan><tspan x="12.297093" y="376.42157" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1026"> * audit_log_*format.  If the task (ctx) is a task that is currently in a</tspan><tspan x="12.297093" y="379.2438" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1028"> * syscall, then the syscall is marked as auditable and an audit record</tspan><tspan x="12.297093" y="382.06601" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1030"> * will be written at syscall exit.  If there is no associated task, then</tspan><tspan x="12.297093" y="384.88824" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1032"> * task context (ctx) should be NULL.</tspan><tspan x="12.297093" y="387.71045" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1034"> */</tspan><tspan x="12.297093" y="390.53268" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1036">struct audit_buffer *audit_log_start(struct audit_context *ctx, gfp_t gfp_mask,</tspan><tspan x="12.297093" y="393.35492" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1038">				     int type)</tspan><tspan x="12.297093" y="396.17712" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1040">{</tspan><tspan x="12.297093" y="398.99936" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1042">	struct audit_buffer *ab;</tspan><tspan x="12.297093" y="401.82156" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1044">	struct timespec64 t;</tspan><tspan x="12.297093" y="404.6438" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1046">	unsigned int uninitialized_var(serial);</tspan><tspan x="12.297093" y="407.466" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1048" /><tspan x="12.297093" y="410.28824" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1050">	if (audit_initialized != AUDIT_INITIALIZED)</tspan><tspan x="12.297093" y="413.11047" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1052">		return NULL;</tspan><tspan x="12.297093" y="415.93268" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1054" /><tspan x="12.297093" y="418.75491" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1056">	if (unlikely(!audit_filter(type, AUDIT_FILTER_EXCLUDE)))</tspan><tspan x="12.297093" y="421.57712" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1058">		return NULL;</tspan><tspan x="12.297093" y="424.39935" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1060" /><tspan x="12.297093" y="427.22156" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1062">	/* NOTE: don't ever fail/sleep on these two conditions:</tspan><tspan x="12.297093" y="430.04379" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1064">	 * 1. auditd generated record - since we need auditd to drain the</tspan><tspan x="12.297093" y="432.86603" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1066">	 *    queue; also, when we are checking for auditd, compare PIDs using</tspan><tspan x="12.297093" y="435.68823" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1068">	 *    task_tgid_vnr() since auditd_pid is set in audit_receive_msg()</tspan><tspan x="12.297093" y="438.51047" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1070">	 *    using a PID anchored in the caller's namespace</tspan><tspan x="12.297093" y="441.33267" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1072">	 * 2. generator holding the audit_cmd_mutex - we don't want to block</tspan><tspan x="12.297093" y="444.15491" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1074">	 *    while holding the mutex */</tspan><tspan x="12.297093" y="446.97711" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1076">	if (!(auditd_test_task(current) || audit_ctl_owner_current())) {</tspan><tspan x="12.297093" y="449.79935" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1078">		long stime = audit_backlog_wait_time;</tspan><tspan x="12.297093" y="452.62158" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1080" /><tspan x="12.297093" y="455.44379" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1082">		while (audit_backlog_limit &amp;&amp;</tspan><tspan x="12.297093" y="458.26602" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1084">		       (skb_queue_len(&amp;audit_queue) &gt; audit_backlog_limit)) {</tspan><tspan x="12.297093" y="461.08823" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1086">			/* wake kauditd to try and flush the queue */</tspan><tspan x="12.297093" y="463.91046" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1088">			wake_up_interruptible(&amp;kauditd_wait);</tspan><tspan x="12.297093" y="466.7327" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1090" /><tspan x="12.297093" y="469.5549" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1092">			/* sleep if we are allowed and we haven't exhausted our</tspan><tspan x="12.297093" y="472.37714" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1094">			 * backlog wait limit */</tspan><tspan x="12.297093" y="475.19934" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1096">			if (gfpflags_allow_blocking(gfp_mask) &amp;&amp; (stime &gt; 0)) {</tspan><tspan x="12.297093" y="478.02158" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1098">				DECLARE_WAITQUEUE(wait, current);</tspan><tspan x="12.297093" y="480.84378" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1100" /><tspan x="12.297093" y="483.66602" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1102">				add_wait_queue_exclusive(&amp;audit_backlog_wait,</tspan><tspan x="12.297093" y="486.48825" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1104">							 &amp;wait);</tspan><tspan x="12.297093" y="489.31046" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1106">				set_current_state(TASK_UNINTERRUPTIBLE);</tspan><tspan x="12.297093" y="492.13269" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1108">				stime = schedule_timeout(stime);</tspan><tspan x="12.297093" y="494.9549" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1110">				remove_wait_queue(&amp;audit_backlog_wait, &amp;wait);</tspan><tspan x="12.297093" y="497.77713" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1112">			} else {</tspan><tspan x="12.297093" y="500.59933" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1114">				if (audit_rate_check() &amp;&amp; printk_ratelimit())</tspan><tspan x="12.297093" y="503.42157" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1116">					pr_warn(&quot;audit_backlog=%d &gt; audit_backlog_limit=%d\n&quot;,</tspan><tspan x="12.297093" y="506.2438" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1118">						skb_queue_len(&amp;audit_queue),</tspan><tspan x="12.297093" y="509.06601" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1120">						audit_backlog_limit);</tspan><tspan x="12.297093" y="511.88824" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1122">				audit_log_lost(&quot;backlog limit exceeded&quot;);</tspan><tspan x="12.297093" y="514.71045" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1124">				return NULL;</tspan><tspan x="12.297093" y="517.53265" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1126">			}</tspan><tspan x="12.297093" y="520.35492" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1128">		}</tspan><tspan x="12.297093" y="523.17712" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1130">	}</tspan><tspan x="12.297093" y="525.99933" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1132" /><tspan x="12.297093" y="528.82159" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1134">	ab = audit_buffer_alloc(ctx, gfp_mask, type);</tspan><tspan x="12.297093" y="531.6438" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1136">	if (!ab) {</tspan><tspan x="12.297093" y="534.466" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1138">		audit_log_lost(&quot;out of memory in audit_log_start&quot;);</tspan><tspan x="12.297093" y="537.28821" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1140">		return NULL;</tspan><tspan x="12.297093" y="540.11047" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1142">	}</tspan><tspan x="12.297093" y="542.93268" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1144" /><tspan x="12.297093" y="545.75488" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1146">	audit_get_stamp(ab-&gt;ctx, &amp;t, &amp;serial);</tspan><tspan x="12.297093" y="548.57715" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1148">	audit_log_format(ab, &quot;audit(%llu.%03lu:%u): &quot;,</tspan><tspan x="12.297093" y="551.39935" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1150">			 (unsigned long long)t.tv_sec, t.tv_nsec/1000000, serial);</tspan><tspan x="12.297093" y="554.22156" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1152" /><tspan x="12.297093" y="557.04382" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1154">	return ab;</tspan><tspan x="12.297093" y="559.86603" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1156">}</tspan><tspan x="12.297093" y="562.68823" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1158" /><tspan x="12.297093" y="565.51044" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1160">/**</tspan><tspan x="12.297093" y="568.3327" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1162"> * audit_expand - expand skb in the audit buffer</tspan><tspan x="12.297093" y="571.15491" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1164"> * @ab: audit_buffer</tspan><tspan x="12.297093" y="573.97711" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1166"> * @extra: space to add at tail of the skb</tspan><tspan x="12.297093" y="576.79938" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1168"> *</tspan><tspan x="12.297093" y="579.62158" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1170"> * Returns 0 (no space) on failed expansion, or available space if</tspan><tspan x="12.297093" y="582.44379" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1172"> * successful.</tspan><tspan x="12.297093" y="585.26599" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1174"> */</tspan><tspan x="12.297093" y="588.08826" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1176">static inline int audit_expand(struct audit_buffer *ab, int extra)</tspan><tspan x="12.297093" y="590.91046" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1178">{</tspan><tspan x="12.297093" y="593.73267" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1180">	struct sk_buff *skb = ab-&gt;skb;</tspan><tspan x="12.297093" y="596.55493" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1182">	int oldtail = skb_tailroom(skb);</tspan><tspan x="12.297093" y="599.37714" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1184">	int ret = pskb_expand_head(skb, 0, extra, ab-&gt;gfp_mask);</tspan><tspan x="12.297093" y="602.19934" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1186">	int newtail = skb_tailroom(skb);</tspan><tspan x="12.297093" y="605.02155" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1188" /><tspan x="12.297093" y="607.84381" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1190">	if (ret &lt; 0) {</tspan><tspan x="12.297093" y="610.66602" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1192">		audit_log_lost(&quot;out of memory in audit_expand&quot;);</tspan><tspan x="12.297093" y="613.48822" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1194">		return 0;</tspan><tspan x="12.297093" y="616.31049" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1196">	}</tspan><tspan x="12.297093" y="619.13269" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1198" /><tspan x="12.297093" y="621.9549" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1200">	skb-&gt;truesize += newtail - oldtail;</tspan><tspan x="12.297093" y="624.7771" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1202">	return newtail;</tspan><tspan x="12.297093" y="627.59937" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1204">}</tspan><tspan x="12.297093" y="630.42157" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1206" /><tspan x="12.297093" y="633.24377" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1208">/*</tspan><tspan x="12.297093" y="636.06604" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1210"> * Format an audit message into the audit buffer.  If there isn't enough</tspan><tspan x="12.297093" y="638.88824" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1212"> * room in the audit buffer, more room will be allocated and vsnprint</tspan><tspan x="12.297093" y="641.71045" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1214"> * will be called a second time.  Currently, we assume that a printk</tspan><tspan x="12.297093" y="644.53265" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1216"> * can't format message larger than 1024 bytes, so we don't either.</tspan><tspan x="12.297093" y="647.35492" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1218"> */</tspan><tspan x="12.297093" y="650.17712" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1220">static void audit_log_vformat(struct audit_buffer *ab, const char *fmt,</tspan><tspan x="12.297093" y="652.99933" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1222">			      va_list args)</tspan><tspan x="12.297093" y="655.82159" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1224">{</tspan><tspan x="12.297093" y="658.6438" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1226">	int len, avail;</tspan><tspan x="12.297093" y="661.466" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1228">	struct sk_buff *skb;</tspan><tspan x="12.297093" y="664.28821" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1230">	va_list args2;</tspan><tspan x="12.297093" y="667.11047" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1232" /><tspan x="12.297093" y="669.93268" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1234">	if (!ab)</tspan><tspan x="12.297093" y="672.75488" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1236">		return;</tspan><tspan x="12.297093" y="675.57715" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1238" /><tspan x="12.297093" y="678.39935" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1240">	BUG_ON(!ab-&gt;skb);</tspan><tspan x="12.297093" y="681.22156" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1242">	skb = ab-&gt;skb;</tspan><tspan x="12.297093" y="684.04382" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1244">	avail = skb_tailroom(skb);</tspan><tspan x="12.297093" y="686.86603" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1246">	if (avail == 0) {</tspan><tspan x="12.297093" y="689.68823" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1248">		avail = audit_expand(ab, AUDIT_BUFSIZ);</tspan><tspan x="12.297093" y="692.51044" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1250">		if (!avail)</tspan><tspan x="12.297093" y="695.3327" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1252">			goto out;</tspan><tspan x="12.297093" y="698.15491" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:2.82222223px;font-family:Exo;-inkscape-font-specification:'Exo, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-feature-settings:normal;text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#08437d;fill-opacity:0.70588235;stroke-width:0.26458332" id="tspan1254">	}</tspan></text>
  </g>
</svg>
